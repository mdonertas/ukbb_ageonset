# README

## SampleQC/Overlap_ExcCat

* Generated by ./scripts/02-UKBB_sampleQC.R
* Plot shows the percent overlap between the exclusions based on different criteria. This is after removal of withdrawn samples and samples without genotypes. 

## SampleQC/Overlap_ExcCat_Heatmap

* Generated by ./scripts/02-UKBB_sampleQC.R
* Plot shows the percent overlap between the exclusions based on different criteria. This is after removal of withdrawn samples and samples without genotypes. 
* A heatmap showing the overlap between exclusions based on different criteria. Values show the percent of the column in the row, e.g. 19.4% of “Rec. Exclusions” are in “Hetero / missing outliers” i) “Hetero / missing outliers”: ‘22027-0.0’ (Outliers for heterozygosity or missing rate), ii) “Rec. Exclusions”: field ‘22010-0.0’ (Recommended genomic analysis exclusions), iii) “High hetero / missing”: ‘22018-0.0’, High heterozygosity rate (after correcting for ancestry) or high missing rate, iv) “Mixed Ancestry”: ‘22018-0.0’, Participant self-declared as having a mixed ancestral background, and v) “Discordant Sex”: as described in the sample QC methods. 

## SampleQC/Het_Miss_Plots

* Generated by ./scripts/02-UKBB_sampleQC.R
* A scatter plot between logit(Missingness) and Heterozygosity for each Ethnic background, defined in UK Biobank. Samples to be excluded are shown as darker points. 

## UKBB_EDA/sex

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Number of male and female participants in UKBB
* x-axis: Sex
* y-axis: Number of participants

## UKBB_EDA/Age_at_death_bySex

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Age at death (every 5 years are binned together) for the participants who died after attending the UKBB assessment centre. The values are corrected for the number of female and male participants who passed each age bin. Total number of deceased male and female participants are specified at the bottom of the plot.
* x-axis: Number of participants in 1,000
* y-axis: Age at death (every 5 years binned together)

## UKBB_EDA/Age_at_death

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The same as UKBB_EDA/Age_at_death_bySex, but not separated by sex, and the coordinates are flipped.
* x-axis: Age at death (every 5 years binned together)
* y-axis: Number of participants in 1000

## UKBB_EDA/baselineAge_bySex

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Age distribution of the participants when they attended UKBB assessment centre
* x-axis: Age
* y-axis: Number of participants

## UKBB_EDA/baselineAge

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The same as UKBB_EDA/baselineAge_bySex but not separated for sex.
* x-axis: Age
* y-axis: Number of participants

## UKBB_EDA/alcohol

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Alcohol drinker status of the participants in UKBB, separated by sex
* x-axis: Number of participants in thousands
* y-axis: Status: current drinker, previous drinker, not a drinker

## UKBB_EDA/deathsinfamily

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The distribution of the participants' answer for the question "Have any of your mother, father, brothers or sisters died suddenly from a non-accidental cause? (Do not include half-, step- or adopted brothers and sisters)"
* x-axis: Number of participants in thousands
* y-axis: Answers: Yes and No

## UKBB_EDA/facialaging

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The distribution of the participants' answer for the question "Do people say that you look:"
* x-axis: Number of participants in thousands
* y-axis: Answers: Younger than you are, older than you are, about your age

## UKBB_EDA/healthratePlot

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The distribution of the participants' answer for the question: "In general how would you rate your overall health?"
* x-axis: Number of participants in thousands
* y-axis: Answers: Poor, Fair, Good, Excellent

## UKBB_EDA/healthsatisPlot

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The distribution of the participants' answer for the question: "In general how satisfied are you with your HEALTH?"
* x-axis: Number of participants in thousands
* y-axis: Extremely happy, very happy, moderately happy, moderately unhappy, very unhappy, extremely unhappy

## UKBB_EDA/smoking

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Cigarette smoking status of the participants in UKBB, separated by sex
* x-axis: Number of participants in thousands
* y-axis: Status: current drinker, previous drinker, not a drinker

## UKBB_EDA/BMI

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: BMI distribution for UKBB participants, for female and male separately. BMI is calculated using Standing Height and Weight columns in the trait data (./scripts/03-prepTraitData.R). 
* x-axis: Sex
* y-axis: BMI

## UKBB_EDA/weight

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Weight distribution for UKBB participants, for female and male separately. 
* x-axis: Sex
* y-axis: Weight in kg

## UKBB_EDA/height

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Height distribution for UKBB participants, for female and male separately. 
* x-axis: Sex
* y-axis: Height in cm

## UKBB_EDA/Parent_Age_at_death

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Distribution of parents' age at death. 391,842 participants reported the age of death of at least one parent.
* x-axis: Average, Maximum or Minimum age at death. If there is data for only one parent, then that value is used as avg, max or min. Otherwise, average, max or min is taken.
* y-axis: Age at death

## UKBB_EDA/menopause

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Age distribution showing when women enter menopause.
* x-axis: Age at menopause
* y-axis: Number of participants

## UKBB_EDA/menarche

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Age distribution showing when the periods of women started
* x-axis: age when periods started
* y-axis: number of participants

## UKBB_EDA/numMed_Op

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Distributions of the number of medications and operations, for female and male separately.
* x-axis: Number of medications or operations
* y-axis: Number of participants (in log10 scale)

## UKBB_EDA/NSRdisease

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Distribution of the number of self-reported diseases
* x-axis: sex
* y-axis: number of self-reported diseases (propagated)

## UKBB_EDA/nSRcancer

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Distribution of the number of self-reported cancers
* x-axis: Number of self-reported cancers
* y-axis: Number of participants

## UKBB_EDA/figure1

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: a plot combining the plots for sex, age, age at death, Height, Weight, BMI

## UKBB_EDA/figure2

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: A plot combining the plots for touchscreen questionnare questions: health rating, health satisfaction, smoking and alcohol drinker status, facial aging, non-accidental deaths in close family. 

## UKBB_EDA/figure3

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: a plot combining parents' age at death, age at menarche, age at menopause plots.

## UKBB_EDA/figure4

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: a plot combining the plots for number of self-reported cancers, number of medications, number of operations.

## UKBB_EDA/correlations

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: Pairwise spearman correlation coefficient between different traits in UKBB. Numbers representing categorical traits are reordered so that they are ordinal. For example, alcohol drinker status has 0 for never, 1 for previous drinker, and 2 for current drinker. Blue color show negative correlation, red color shows positive correlation and darker colors show stronger correlations. The traits are ordered by the hierarchical clustering of correlations.

## UKBB_EDA/correlations_trimmed_below02

* Generated by ./scripts/07-UKBB_EDA.R
* Plot: The same as UKBB_EDA/correlations except that we changed the value of correlations lower than 0.2 to 0 (or for negative correlations those higher than -0.2 to 0). This is just for easier inspection of the results.

## UKBB_disease_EDA/disTree

* Generated by ./scripts/08-UKBB_SRDiseases.R
* Disease hierarchy for the self-reported diseases in UK Biobank.

## UKBB_disease_EDA/disPrevScatter

* Generated by ./scripts/08-UKBB_SRDiseases.R
* The distribution of disease prevalence in males and females. The x- and y-axes show the number of cases in 1,000 males and females (in log scale), respectively. The color of each point shows if that disease has more prevalence in females (rosy brown) or males (slate gray). The linear regression line is depicted as blue. Diseases having a residual value bigger than 3 standard deviations are labeled.

## UKBB_disease_EDA/numDiseases_perInd

* Generated by ./scripts/08-UKBB_SRDiseases.R
* The distribution of number of self-reported diseases (y-axis) in stratified by sex (x-axis).

## UKBB_disease_EDA/top10dis_bysex

* Generated by ./scripts/08-UKBB_SRDiseases.R
* The list of top 20 diseases with the highest overall prevalence. The x-axis shows the number of cases in 1,000, while the y-axis lists the diseases by their occurrences. The color of bars show the prevalences in females and males.

## UKBB_disease_EDA/figure1

* Generated by ./scripts/08-UKBB_SRDiseases.R
* Figure combining numDiseases_perInd, disPrevScatter, and top10dis_bysex. 

## UKBB_disease_EDA/disFiltering

* Generated by ./scripts/09-SRDisease_FilteringEDA.R
* Figure similar to disPrevScatter but highlighting female-specific, male-specific areas as well as are for the diseases with a prevalence higher than 0.001 in both females and males. The diseases with more than 2,000 cases are shown with darker color. 

## selectedDisease_EDA/disTree_selected

* Generated by ./scripts/10-SelectedDisease_EDA.R
* Selected 116 diseases in UKBB Disease hierarchy. The dark dots show the selected diseases whereas the light ones are the diseases that did not satisfy our selection criteria. 

## selectedDisease_EDA/disTree_selected2

* Generated by ./scripts/10-SelectedDisease_EDA.R
* Disease hierarchy for the 116 diseases included in the downstream analysis. The nodes are coloured by the disease categories as indicated in the legend. 

## selectedDisease_EDA/numDiseases_perInd

* Generated by ./scripts/10-SelectedDisease_EDA.R
* The distribution of the number of self-reported diseases (y-axis) in stratified by sex (x-axis) but only considering the 116 diseases included in downstream

## selectedDisease_EDA/disPrevScatter

* Generated by ./scripts/10-SelectedDisease_EDA.R
* The distribution of disease prevalence in males and females. The x- and y-axes show the number of cases in 1,000 males and females (in log scale), respectively. The colour of each point shows if that disease has more prevalence in females (rosy brown) or males (slate grey). The linear regression line is depicted as blue. Diseases having a residual value bigger than 3 standard deviations are labelled. Only for diseases included in downstreeam

## selectedDisease_EDA/figure1

* Generated by ./scripts/10-SelectedDisease_EDA.R
* Combination of numDiseases_perInd and disPrevScatter

## selectedDisease_EDA/agestrNumdis_5

* Generated by ./scripts/10-SelectedDisease_EDA.R
* The mean and maximum number of diseases per participant for different age groups and sexes. The x-axis shows age groups and the y-axis shows number of diseases. The number of diseases per age group only considers the diseases that are diagnosed within that period and ignores if the disease is a chronic or acute disease. Ages are binned into every 5 years.

## selectedDisease_EDA/agestrNumdis_10

* Generated by ./scripts/10-SelectedDisease_EDA.R
* The same as agestrNumdis_5 but ages are binned into every 10 years.

## selectedDisease_EDA/age_cat_strdis

* Generated by ./scripts/10-SelectedDisease_EDA.R
* The average number of diseases per participant for different age groups, sexes, and disease categories. The x-axis shows age groups and the y-axis shows number of diseases.  The number of diseases per age group only considers the diseases that are diagnosed within that period and ignores if the disease is a chronic or acute disease. Ages are binned into every 10 years.

## diseaseCooccur/RRmat_log2_all

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* Heatmap showing the log2 Risk ratios calculated between diseases. The matrix is not symmetrical as RR is not symmetrical. Columns and rows are also annotated with the disease categories and median age of onset. This heatmap is created without any significance cutoff.

## diseaseCooccur/RRnet_log2_sig_log2RR1

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* Network summarising the diseases that has significant associations (If the 95% CI for RR does not include 1). Each node shows a disease, colored by disease categories. Edge width is defined by abs(log2(RR)), whereas the color shows the sign - blue for negative, red for positive association. Diseases are associated only if abs(log2(RR))>=1.
* RRnet_log2_sig_log2RR1_nolabel - is the same network with no disease labels. 

## diseaseCooccur/RRnet_log2_sig_log2RR2

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* The same as RRnet_log2_sig_log2RR1, except only the associations with abs(log2(RR))>=2 are drawn.

## diseaseCooccur/RRnet_log2_sig_log2RR3

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* The same as RRnet_log2_sig_log2RR1, except only the associations with abs(log2(RR))>=3 are drawn.

## diseaseCooccur/RRmat_log2_sig_log2RR2_*

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* Heatmap showing the log2 Risk ratios calculated between diseases. The matrix is not symmetrical as RR is not symmetrical. Columns and rows are also annotated with the disease categories and median age of onset. RRs are calculated by considering the age of onset - e.g. for the file RRmat_log2_sig_log2RR2_(0,10], we only considered people with a disease age of onset between age of 0 to 10 as having that disease and all others as not having the disease. We only display the RRs that are significant (95% does not include 1), and abs(log2(RR))>=2. Other associations are shown with 0.

## diseaseCooccur/ORmat_log2_all

* Generated by ./scripts/11-diseaseCooccurrences-OR.R
* Heatmap showing the log2 Odds ratios calculated between diseases. The matrix is symmetrical. Columns and rows are also annotated with the disease categories and median age of onset. This heatmap is created without any significance cutoff.

## diseaseCooccur/ORnet_log2_sig_log2OR1

* Generated by ./scripts/11-diseaseCooccurrences-OR.R
* Network summarising the diseases that has significant associations (If the 95% CI for OR does not include 1). Each node shows a disease, colored by disease categories. Edge width is defined by abs(log2(OR)), whereas the color shows the sign - blue for negative, red for positive association. Diseases are associated only if abs(log2(OR))>=1.
* ORnet_log2_sig_log2OR1_nolabel - is the same network with no disease labels. 

## diseaseCooccur/ORnet_log2_sig_log2OR2

* Generated by ./scripts/11-diseaseCooccurrences-OR.R
* The same as ORnet_log2_sig_log2OR1, except only the associations with abs(log2(OR))>=2 are drawn.

## diseaseCooccur/ORnet_log2_sig_log2OR3

* Generated by ./scripts/11-diseaseCooccurrences-OR.R
* The same as ORnet_log2_sig_log2OR1, except only the associations with abs(log2(OR))>=3 are drawn.

## diseaseCooccur/cormat_all

* Generated by ./scripts/11-diseaseCooccurrences-cor.R
* A heatmap showing the pearson correlation coefficients between diseases. The matrix is symmetrical. Columns and rows are also annotated with the disease categories and median age of onset. This heatmap is created without any significance cutoff.

## diseaseCooccur/cormat_h01

* Generated by ./scripts/11-diseaseCooccurrences-cor.R
* A heatmap showing the pearson correlation coefficients between diseases, only if abs(r)>=0.1. The matrix is symmetrical. Diseases with no correlation that is higher than 0.1 or lower than -0.1 are not drawn. Columns and rows are also annotated with the disease categories and median age of onset. 

## diseaseCooccur/SRmat_log2_log2SR2

* Generated by ./scripts/11-diseaseCooccurrences-sexRatio.R
* A heatmap showing the sex ratios between diseases. The matrix is asymmetrical. This heatmap only shows the sex ratios where abs(sex ratio)>=2, in log scale. So a red cell with sex ratio = 2 means this comorbidity is seen 4 times more in females.

## diseaseCooccur/or_rr_correlation

* Generated by ./scripts/11-diseaseCooccurrences-combineScores.R
* Hexplot for the association between ranks of OR and RR. 

## diseaseCooccur/disAssoc

* Generated by ./scripts/11-diseaseCooccurrences-combineScores.R
* An association plot where the size of tiles are determined by the correlation between diseases and the color is determined by the risk ratios. Diseases are ordered by hierarchical clustering of risk ratios. Associations between all diseases are plotted without a significance cutoff.
* disAssoc_nolabel is the same plot without disease labels

## diseaseCooccur/figure1

* Generated by ./scripts/11-diseaseCooccurrences-combineScores.R
* Plot combining or_rr_correlation and disAssoc_nolabel

## diseaseCooccur/disAssoc_log2RR1

* Generated by ./scripts/11-diseaseCooccurrences-combineScores.R
* An association plot where the size of tiles are determined by the correlation between diseases and the color is determined by the risk ratios. Diseases are ordered by hierarchical clustering of risk ratios. Only the associations for diseases with at least one association with abs(RR)>=1 are plotted.

## diseaseCooccur/disAssoc_log2RR2

* Generated by ./scripts/11-diseaseCooccurrences-combineScores.R
* An association plot where the size of tiles are determined by the correlation between diseases and the color is determined by the risk ratios. Diseases are ordered by hierarchical clustering of risk ratios. Only the associations for diseases with at least one association with abs(RR)>=2 are plotted.
