# README

## processed/ukbb/helperfiles/ukbfields.tsv

* Generated by ./scripts/02-UKBB_sampleQC.R
* Decoded UKBB field names to field ID, visit, and number, including the definition of field IDs. 

## processed/ukbb/sampleQC/discSex_exclusions.tsv

* Generated by ./scripts/02-UKBB_sampleQC.R
* The list of sample ids excluded from the analysis based on the discordant sex criteria.

## processed/ukbb/sampleQC/recommended_exclusions.tsv

* Generated by ./scripts/02-UKBB_sampleQC.R
* The list of sample ids excluded based on UK Biobank recommendation, considering heterozygosity and missingness.

## processed/ukbb/sampleQC/all_exclusions.rds

* Generated by ./scripts/02-UKBB_sampleQC.R
* A list object with the sample IDs excluded based on different criteria.

## processed/ukbb/sampleQC/sampleIDs_passedQC.tsv

* Generated by ./scripts/02-UKBB_sampleQC.R
* The list of sample IDs that passed the QC process. 

## processed/traits_clean/traitData_baseline(.rds|.tsv)

* Generated by ./scripts/03-prepTraitData.R
* Includes the following information for 484,598 samples that passed the QC.

```{r}
> colnames(traitbaseline)
 [1] "eid"                                         
 [2] "Sex"                                         
 [3] "Standing height"                             
 [4] "Number of self-reported cancers"             
 [5] "Number of self-reported non-cancer illnesses"
 [6] "Number of operations, self-reported"         
 [7] "Number of treatments/medications taken"      
 [8] "Sleep duration"                              
 [9] "Facial ageing"                               
[10] "Maternal smoking around birth"               
[11] "Father's age at death"                       
[12] "Overall health rating"                       
[13] "Age when periods started (menarche)"         
[14] "Mother's age at death"                       
[15] "Age at menopause (last menstrual period)"    
[16] "Non-accidental death in close genetic family"
[17] "Health satisfaction"                         
[18] "Smoking status"                              
[19] "Alcohol drinker status"                      
[20] "Weight"                                      
[21] "Age when attended assessment centre"         
[22] "Age at recruitment"                          
[23] "Age at death"
```

## processed/traits_clean/SRDisease_baseline(.rds|.tsv)

* Generated by ./scripts/03-prepTraitData.R
* Includes the following information for 362,772 samples that passed the QC and has at least one disease (note that the number of entries (904,035) is higher than the number of samples as one sample can have more than one disease).

```{r}
> colnames(SRdiseasebaseline)
[1] "eid"        "diseaseID" 
[3] "Disease"    "node_id"   
[5] "parent_id"  "selectable"
[7] "Age"
```

## processed/traits_clean/SRcancer_baseline(.rds|.tsv)

* Generated by ./scripts/03-prepTraitData.R
* Includes the following information for 39,910 samples that passed the QC and has at least one disease (note that the number of entries (42,852) is higher than the number of samples as one sample can have more than one type of cancer).

```{r}
> colnames(SRcancerbaseline)
[1] "eid"        "cancerID"   "Cancer"     "node_id"    "parent_id"  
[6] "selectable" "Age"
```

## processed/traits_clean/SRDisease_baseline_propagated.rds

* Generated by ./scripts/03-prepTraitData.R
* The self-reported diseases in UK Biobank are not independent, but rather are organized in a hierarchical manner. Using the relationship information between diseases, we propagate disease-participant associations. For example, if a person reports having “essential hypertension”, we also annotate that person with “hypertension”, and “cardiovascular disease”.
* Includes the following information for 362,772 samples that passed the QC and has at least one disease (note that the number of entries (2,242,698) is higher than the number of samples as one sample can have more than one disease).

```{r}
> colnames(SRdiseasebaseline)
[1] "eid"        "diseaseID" 
[3] "Disease"    "node_id"   
[5] "parent_id"  "selectable"
[7] "Age"
```
* Age: Using the minimum age at diagnosis for all the diseases that are child term for a particular disease, we re-defined age at diagnosis information.

## processed/traits_clean/traitData_baseline_additions.rds

* Generated by ./scripts/03-prepTraitData.R
* Includes the following information for 484,598 samples that passed the QC.

```{r}
> colnames(traits)
 [1] "eid"                                          "nSRdiseaseProp"                              
 [3] "nSRcancer"                                    "nSRdisease"                                  
 [5] "Sex"                                          "Standing height"                             
 [7] "Number of self-reported cancers"              "Number of self-reported non-cancer illnesses"
 [9] "Number of operations, self-reported"          "Number of treatments/medications taken"      
[11] "Sleep duration"                               "Facial ageing"                               
[13] "Maternal smoking around birth"                "Father's age at death"                       
[15] "Overall health rating"                        "Age when periods started (menarche)"         
[17] "Mother's age at death"                        "Age at menopause (last menstrual period)"    
[19] "Non-accidental death in close genetic family" "Health satisfaction"                         
[21] "Smoking status"                               "Alcohol drinker status"                      
[23] "Weight"                                       "Age when attended assessment centre"         
[25] "Age at recruitment"                           "Age at death"                                
[27] "BMI"                                          "Parent Min Age at Death"                     
[29] "Parent Max Age at Death"                      "Parent Avg Age at Death" 
```

* nSRdisease: The number of unique self-reported non-cancer illnesses each participant informed in the baseline recruitment. 
* nSRdiseaseProp: The number of unique self-reported diseases each participant has after the data propagation.
* nSRcancer: The number of unique self-reported cancers each participant informed in the baseline recruitment.
* BMI: Using the columns for ‘Weight’ and ‘Standing height’ we calculated BMI based on the following formula: “Weight / (Standing Height / 100)^2”
* Parent Min Age at Death: The age at which the first deceased parent died. If none of the parents died, or if the data is unavailable, this column is set to be NA. If only one parent died, we use the corresponding age as the minimum. 
* Parent Max Age at Death: The age at which the second deceased parent died. If none of the parents died, or if the data is unavailable, this column is set to be NA. If only one parent died, we use the corresponding age as the maximum. 
* Parent Avg Age at Death: The age at which the first deceased parent died. If none of the parents died, or if the data is unavailable, this column is set to be NA. If only one parent died, we use the corresponding age as the average. 


## processed/traits_clean/SRdisease_prop_prevdf.rds

* Generated by ./scripts/04-DiseaseSet.R
* For all 472 self reported disease in UK Biobank, includes the following information:
    * Disease: Name of the disease
    * Female: Number of females with the disease
    * Male: Number of males with the disease
    * fPrev: Disease frequency among females (N in 1,000)
    * mPrev: Disease frequency among males (N in 1,000)
    * nCases: Total number of samples with the disease
    * fCase: Overall disease frequency (N in 1,000)
    
## processed/traits_clean/SRdiseaseSet.rds

* Generated by ./scripts/04-DiseaseSet.R
* A subset of processed/traits_clean/SRdisease_prop_prevdf.rds including only the diseases to be analysed by GWAS. This set includes 116 that are not sex specific, common, and with at least 2,000 cases in UK Biobank.

## processed/traits_clean/traitData_baseline_additions2.rds

* Generated by ./scripts/03-prepTraitData.R
* Now we include the age when last person in UKBB died, so that we can normalize with the number of people passing certain age.

## processed/ukbb/gwas/fam4bolt/*.fam

* Generated by ./scripts/prepGWAS/01-fix_fam_files.R
* UKBiobank data has batch in its phenotype column. But this field is coded with characters, whereas BOLT-LMM requires fam files to consist of all numeric values. Using the script we convert the sixth column to numeric equivalents.

## processed/ukbb/gwas/remove/*.fam

* Generated by ./scripts/prepGWAS/01-removeFiles4bolt.R
* BOLT-LMM accepts a list of individuals to be removed from the analysis as an input. These files are called ‘remove’ files and are in the FAM format. We prepared these files for i) withdrawn samples (withdrawn.fam - n = 51), ii) samples that failed the quality control (sampleQC_exc.fam - n = 3,779), iii) samples that have information in PLINK files but lack BGEN files (inplink_notin_bgen.fam - n = 968), and in order to run GWAS using only females or males, we also prepared files including iv) males (males.fam - n = 221,840) and v) females (famelas.fam - n = 262,758).

## processed/ukbb/gwas/fam4bolt/

* Generated by ./scripts/prepGWAS/01-fix_fam_files.R
* In UK Biobank FAM files, the column for ‘phenotype’ includes batch that is coded with characters. In order to use BOLT-LMM, we updated all the entries in this column to numeric values.

## processed/ukbb/gwas/remove/withdrawn.fam

* Generated by ./scripts/prepGWAS/02-removeFiles4bolt.R
* In UK Biobank, some individuals requested withdrawal of their data after we had access. We prepare 'remove files' for these individuals in fam format.

## processed/ukbb/gwas/remove/sampleQC_exc.fam

* Generated by ./scripts/prepGWAS/02-removeFiles4bolt.R
* Using the trait data prepared by ./scripts/02-UKBB_sampleQC.R, we prepare 'remove files' for the individuals that are not in this file.

## processed/ukbb/gwas/remove/inplink_notin_bgen.fam

* Generated by ./scripts/prepGWAS/02-removeFiles4bolt.R
* FAM files prepared for the samples that have information in PLINK files but lack BGEN files.

## processed/ukbb/gwas/remove/males.fam

* Generated by ./scripts/prepGWAS/02-removeFiles4bolt.R
* In case we want to run sex specific GWAS using females only, we prepared a 'remove file' for males.

## raw/ukbb/genotypes/

* Generated by ./scripts/prepGWAS/03-unzip4plink.sh.
* Plink does not work well with zipped files. So we created a local copy of the genotype files. Here we also include fam files under ./data/processed/ukbb/gwas/fam4bolt since it is easier to run code when all bed bim fam files are together.

## processed/ukbb/gwas/hwe

* Generated by ./scripts/prepGWAS/04-calcSNPstats.sh
* Hardy-Weinberg equilibrium stats calculated using PLINK.

## processed/ukbb/gwas/freq

* Generated by ./scripts/prepGWAS/04-calcSNPstats.sh
* Allele frequencies calculated using PLINK.

## processed/ukbb/gwas/exclude/hwe.txt

* Generated by ./scripts/prepGWAS/05-excludeFiles4bolt.R
* SNPs with a p<=1e-6 (n = 202,473).

## processed/ukbb/gwas/exclude/maf.txt

* Generated by ./scripts/prepGWAS/05-excludeFiles4bolt.R
* SNPs with MAF < 0.01 (n = 314,697).

## processed/ukbb/gwas/pheno/phenoFile_noChar.pheno

* Generated by ./scripts/prepGWAS/06-phenoFile.R
* We created a phenotype file that can be used as an input for BOLT-LMM, including the following fields: sex, age when attended assessment centre, calculated BMI, assessment centre, ethnicity, batch, first 20 PCs, self-reported diseases (one column per disease), having any self-reported disease, self-reported cancers, having any self-reported cancer, having any self-reported disease or cancer, disease age-of-onset (one column per disease).

## processed/ukbb/gwas/bolt/*.stats

* Generated by ./scripts/06-runGWAS.sh
* For each disease (n:116) 2 files are generated: $disID.stat (nrow: 449,803) and $disID.imp.stat (nrow: 9,886,869) - these two files have the same format, decribed in https://data.broadinstitute.org/alkesgroup/BOLT-LMM/

## processed/traits_clean/SRdisease_baseline_propagated_selected.rds

* Generated by ./scripts/10-SelectedDisease_EDA.R
* Subset of processed/traits_clean/SRdisease_baseline_propagated.rds which only includes diseases in processed/traits_clean/SRdiseaseSet.rds

## processed/traits_clean/disMat.rds

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* A matrix, where the rows are participant ids (eid), and columns are different self-reported diseases. The matrix comprised of 0s and 1s, indicating if that individual has that particular disease. This data is generated only for the 116 diseases that will be analysed in our study and it contains data after propagation to the upper levels. So, for example, if a participant has 'essentioal hypertension' then that person also has 'hypertension'.

## processed/traits_clean/disAgeMat.rds

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* A matrix, where the rows are participant ids (eid), and columns are different self-reported diseases. The matrix is comprised of disease age of onsets, indicating when that individual was diagnosed with that particular disease. If there is no age reported, or that participant doesn't have that particular disease, then the value is NA. 

## processed/diseaseCooccur/RRtable

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* A table including diseaseA, diseaseB, Nab, Nnab, Ta, Tna, Pexp, Pnexp, RR, cif, ll, ul, and whether disease A is an ancestor/descendent of disease B. 

|           |disaaseB|no diseaseB|Total|
|-----------|:------:|:---------:|:---:|
|   diseaseA|     Nab|       Nanb|   Ta|
|no diseaseA|    Nnab|      Nnanb|  Tna|

* Pexp = Nab / Ta
* Pnexp = Nnab / Tna
* RR = Pexp / Pnexp
* cif = sqrt((((Ta - Nab) / Nab) / Ta) + (((Tna - Nnab) / Nnab) / Tna))
* ll = exp(log(RR) - (1.96 * cif))
* ul = exp(log(RR) + (1.96 * cif))

## processed/diseaseCooccur/RRtable_agebins

* Generated by ./scripts/11-diseaseCooccurrences-RR.R
* The same as RRtable except, this file also includes 'age' column as the numbers are calculated only for certain age periods.

## processed/diseaseCooccur/ORtable

* Generated by ./scripts/11-diseaseCooccurrences-OR.R
* A table including diseaseA, diseaseB, Nab, Nnab, Nanb, Nnanb, OR, ll, ul, p, and whether disease A is an ancestor/descendent of disease B. 
* Odds ratio, lower and upper limit of the confidence intervals and p values are calculated using fisher.test function. 

## processed/diseaseCooccur/disCorrelations

* Generated by ./scripts/11-diseaseCooccurrences-cor.R
* A correlation matrix, including pairwise spearman correlation coefficients between diseases. 
* 
